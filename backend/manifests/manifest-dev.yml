---
applications:
  - name: gsa-fac
    buildpacks:
      - python_buildpack
    memory: 512M
    path: ../
    health-check-type: process
    timeout: 180
    env:
      ENV: DEVELOPMENT
      DJANGO_BASE_URL: https://fac-dev.app.cloud.gov
      ALLOWED_HOSTS: fac-dev.app.cloud.gov
      AV_SCAN_URL: https://fac-av-dev.apps.internal:61443/scan
      # The following is commented out because collectstatic in the buildpack phase does not seem to be working, so we're running it in .profile.
      # If we find out what's broken, or it's fixed up stream, then we can decide whether or not we want to disable it.
      # DISABLE_COLLECTSTATIC: true
    routes:
      - route: fac-dev.app.cloud.gov
    instances: 1
    services:
      - fac-db
      - fac-public-s3
      - fac-key-service
      - dev-deployer

  - name: postgrest
    instances: 1
    disk_quota: 256M
    memory: 128M
    timeout: 180
    docker:
      image: postgrest/postgrest:v10.1.2
    routes:
      - route: fac-dev-postgrest.app.cloud.gov
    env:
      PGRST_DB_URI: ((DB_URI))
      PGRST_DB_ANON_ROLE: anon

  - name: swagger
    instances: 1
    disk_quota: 256M
    memory: 256M
    timeout: 20
    health-check-type: process
    docker:
      image: swaggerapi/swagger-ui
    routes:
      - route: fac-dev-swagger.app.cloud.gov
    env:
      API_URL: https://fac-dev-postgrest.app.cloud.gov
      SWAGGER_JSON_URL: https://fac-dev-postgrest.app.cloud.gov/
    port: 8080
